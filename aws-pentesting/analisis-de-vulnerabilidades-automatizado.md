# Análisis de vulnerabilidades Automatizado



## Herramientas

### Prowler

Prowler es una herramienta de seguridad open source para realizar evaluaciones de prácticas recomendadas de seguridad de AWS, auditorías, respuesta a incidentes, monitorización continua, hardening y preparación forense. Contiene más de 200 controles que cubren CIS, PCI-DSS, ISO27001, GDPR, HIPAA, FFIEC, SOC2, AWS FTR, ENS y marcos de seguridad de clientes.

<figure><img src="../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/prowler-cloud/prowler.git" %}

### Cloudsplaining

Cloudsplaining es una herramienta de evaluación de la seguridad de AWS IAM que identifica las violaciones del mínimo privilegio y genera un informe HTML con prioridad de riesgo.

&#x20;Cloudsplaining identifica las violaciones del mínimo privilegio en las políticas de AWS IAM y genera un bonito informe HTML con una hoja de trabajo. Puede escanear todas las políticas de su cuenta de AWS o puede escanear un solo archivo de políticas.&#x20;

Ayuda a identificar las acciones de IAM que no aprovechan las limitaciones de recursos. También ayuda a priorizar el proceso de remediación marcando las políticas de IAM que presentan los siguientes riesgos para la cuenta de AWS en cuestión sin restricciones:&#x20;

* Exfiltración de datos (s3:GetObject, ssm:GetParameter, secretsmanager:GetSecretValue) Modificación de la infraestructura
* Exposición de recursos (la capacidad de modificar las políticas basadas en recursos)
* Escalada de privilegios (basada en la investigación de Rhino Security Labs)

#### Uso básico

```
aws iam get-account-authorization-details > OutputAnalisis.txt
./cloudsplaining scan --input-file ./OutputAnalisis.txt
```



<figure><img src="../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/salesforce/cloudsplaining" %}

{% embed url="https://cloudsplaining.readthedocs.io/en/latest/" %}

### Pacu

<mark style="color:green;">Pacu</mark> es un framework de AWS de código abierto, diseñado para realizar pruebas de seguridad ofensivas contra entornos en la nube. Creado y mantenido por Rhino Security Labs, <mark style="color:green;">Pacu</mark> permite a los pentesters explotar los defectos de configuración dentro de una cuenta de AWS, utilizando módulos para ampliar fácilmente su funcionalidad. Los módulos actuales permiten una serie de ataques, incluyendo la escalada de privilegios de los usuarios, el backdooring de los usuarios de IAM, el ataque a funciones Lambda vulnerables, y mucho más.

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/RhinoSecurityLabs/pacu" %}

### CCAT - Cloud Container Attack Tool

Aunque ha habido investigaciones y desarrollo de herramientas sobre contenedores y su seguridad, la mayoría de ellas se centran en el análisis de imágenes y la búsqueda de vulnerabilidades conocidas. En el 2020 surgió la creación de una herramienta llamada Cloud Container Attack Tool y esta fue desarrollada por el equipo de Rhyno Security Labs. CCAT utiliza contenedores para la explotación en la nube a través de puertas traseras e imágenes de Docker maliciosas.

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/RhinoSecurityLabs/ccat" %}

### Cartography

Es una herramienta de Python que consolida los activos de infraestructura y las relaciones entre ellos en una vista gráfica intuitiva con la tecnología de una base de datos Neo4j.&#x20;

Cartography tiene como objetivo permitir un amplio conjunto de escenarios de exploración y automatización. Es particularmente bueno para exponer las relaciones de dependencia ocultas entre los activos de su servicio para que pueda validar las suposiciones sobre los riesgos de seguridad

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/lyft/cartography" %}

### Stratus Red Team

Stratus Red Team es un binario autónomo. Puede usarlo para detonar fácilmente técnicas de ataque ofensivo contra un entorno de nube en vivo. Ejemplo de uso: detener un estrato de CloudTrail Trail (Defense Evasion) detona aws.defense-evasion.cloudtrail-stop.

Stratus Red Team es "Atomic Red Team™" para la nube, lo que permite emular técnicas de ataque ofensivo de manera granular y autónoma.

<figure><img src="../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

{% embed url="https://github.com/DataDog/stratus-red-team.git" %}

{% embed url="https://stratus-red-team.cloud/" %}







