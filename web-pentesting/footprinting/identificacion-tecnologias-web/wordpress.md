---
description: Pentesting a sitios wordpress
---

# WordPress

## Info

WordPress es un CMS de código abierto muy popular que fue lanzado en 2003. Es utilizado por millones de sitios web en todo el mundo y se destaca por su facilidad de uso y flexibilidad. Con WordPress, los usuarios pueden crear y personalizar sitios web sin necesidad de conocimientos de programación avanzados. Además, cuenta con una amplia variedad de plantillas y plugins que permiten añadir funcionalidades adicionales al sitio.



Los archivos se guardan por defecto en la siguiente ruta:

```
https://somecoolweb.com/wp-content/uploads/2018/08/a.txt
```

### Listado de usuarios

```bash
# Por Get Author
http://blog.example.com/?author=1


# Listado json
http://blog.example.com/wp-json/wp/v2/users

## /wp-json/wp/v2/pages  Puede Likear la IP
```

### XML-RPC

Si xml-rpc.php está activo puedes realizar una fuerza bruta de credenciales o usarlo para lanzar ataques DoS a otros recursos. (Puedes automatizar este proceso usando [https://github.com/relarizky/wpxploit](https://github.com/relarizky/wpxploit)). Para ver si está activo intenta acceder a /xmlrpc.php y envía esta petición:

```xml
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```

#### Bruteforce de credenciales

<mark style="color:green;">**wp.getUserBlogs**</mark>, <mark style="color:green;">**wp.getCategories**</mark> o <mark style="color:green;">**metaWeblog.getUsersBlogs**</mark> son algunos de los métodos que se pueden utilizar para hacer fuerza bruta con las credenciales. Si puedes encontrar alguno de ellos puedes enviar algo como:

```xml
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```

<figure><img src="../../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

## Tools

### wpscan

Una de las herramientas que utilizamos en esta clase para enumerar este gestor de contenido es **Wpscan**. Wpscan es una herramienta de código abierto que se utiliza para escanear sitios web en busca de vulnerabilidades de seguridad en WordPress.

Con Wpscan, podemos realizar una enumeración completa del sitio web y obtener información detallada sobre la instalación de WordPress, como la versión utilizada, los plugins y temas instalados y los usuarios registrados en el sitio. También nos permite realizar pruebas de fuerza bruta para descubrir contraseñas débiles y vulnerabilidades conocidas en plugins y temas.&#x20;

{% hint style="info" %}
Para sacar el máximo provecho de la herramienta, es necesario generar un API token, con este token los escaneos de vulnerabilidades sobre plugins dará mas información.
{% endhint %}

Wpscan es una herramienta muy útil para los administradores de sitios web que desean mejorar la seguridad de su sitio WordPress, ya que permite identificar y corregir vulnerabilidades antes de que sean explotadas por atacantes malintencionados. Además, es una herramienta fácil de usar y muy efectiva para identificar posibles debilidades de seguridad en nuestro sitio web.

El uso de esta herramienta es bastante sencillo, a continuación se indica la sintaxis básica:

{% code overflow="wrap" %}
```bash
wpscan --url https://example.com
```
{% endcode %}

Si deseas enumerar usuarios o plugins vulnerables en WordPress utilizando la herramienta wpscan, puedes añadir los siguientes parámetros a la línea de comandos:

{% code overflow="wrap" %}
```bash
wpscan --url https://example.com --enumerate u
```
{% endcode %}

En caso de querer enumerar plugins existentes los cuales sean vulnerables, puedes añadir el siguiente parámetro a la línea de comandos:

{% code overflow="wrap" %}
```bash
wpscan --url https://example.com --enumerate vp
```
{% endcode %}

{% embed url="https://github.com/wpscanteam/wpscan" %}

Comando avanzado para utilizar junto con burp

{% code overflow="wrap" %}
```bash
wpscan --url https://example.com --output wpsscan_example.com --no-banner --random-user-agent --disable-tls-checks --proxy http://127.0.0.1:8080 --api-token <API-WPSScan> --no-update
```
{% endcode %}

## Laboratorio

{% embed url="https://github.com/vavkamil/dvwp" %}
