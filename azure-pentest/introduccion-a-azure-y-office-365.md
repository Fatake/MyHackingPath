# Introducción a Azure y Office 365

## ¿Qué es Microsoft Azure?

Azure es la plataforma publica de servicios en la nube de Microsoft. Esta plataforma consta de múltiples servicios para que sus clientes puedan desarrollar, hospedar y proveer sus aplicaciones y servicios. Esta plataforma se encuentra en constante crecimiento y desarrollo, agregando mas y mejores prestaciones a su entorno, con la finalidad de mantenerse al nivel que sus competidores (Amazon Web Services, Google Cloud Platform).

<figure><img src="../.gitbook/assets/image (3) (2) (1).png" alt=""><figcaption></figcaption></figure>

## Tipos de Infraestructura

<figure><img src="../.gitbook/assets/image (23) (2).png" alt=""><figcaption></figcaption></figure>

### On-Premise&#x20;

La infraestructura On-Premises (en las instalaciones) se refiere a la infraestructura de tecnología que se ubica en las instalaciones de una organización. En este caso, la empresa es responsable de administrar y mantener sus propios servidores, almacenamiento, redes y otros componentes de infraestructura de tecnología en sus propias instalaciones. Esto significa que la empresa es responsable de la compra, la instalación, la configuración y el mantenimiento de todo su hardware y software en el lugar donde operan.

### Cloud Base

la infraestructura Cloud se refiere a la infraestructura de tecnología que se encuentra en un entorno virtualizado en la nube, en lugar de en las instalaciones de una organización. En este caso, los servicios de infraestructura, como los servidores, el almacenamiento, las redes y otros componentes de tecnología, se proporcionan como servicios a través de Internet por un proveedor de servicios de la nube, como Microsoft Azure, Amazon Web Services (AWS), o Google Cloud Platform (GCP). En lugar de comprar y mantener sus propios servidores y equipo de red, las empresas pueden alquilar infraestructura en la nube para alojar y ejecutar sus aplicaciones y servicios.

## Regiones

Para que Azure pueda funcionar correctamente y cumpla con las leyes de los distintos gobiernos donde se ofrece este servicio, Microsoft opto por tener diferentes nubes para que se adapten a los múltiples mercados. Estas nubes ejecutan la misma tecnología y proveen los mismos servicios, pero se alojan en varios centros de datos independientes unos de otros, tanto físicamente como lógicamente. Tomando esto en cuenta, se listan los diferentes Endpoints con los que cuenta Microsoft en la siguiente tabla:

| Plataforma                     | Endpoint                                                                                                                                                                              |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Azure Commercial               | <p>Portal: <a href="https://portal.azure.us/">https://portal.azure.us</a></p><p>AD Endpoint: <a href="https://login.microsoftonline.us/">https://login.microsoftonline.us</a></p>     |
| Azure United States Government | <p>Portal: <a href="https://portal.azure.com/">https://portal.azure.com</a></p><p>AD Endpoint: <a href="https://login.microsoftonline.com/">https://login.microsoftonline.com</a></p> |
| Azure China                    | <p>Portal: <a href="https://portal.azure.cn/">https://portal.azure.cn</a></p><p>AD Endpoint: <a href="https://login.chinacloudapi.cn/">https://login.chinacloudapi.cn</a></p>         |
| Azure Germany                  | <p>Portal: <a href="https://portal/">https://portal</a>.microsoft.de</p><p>AD Endpoint: https://login.microsoftonline.de</p>                                                          |



## &#x20;Jerarquía de gestión de recursos en Azure

La estructura de organización en Azure consiste de los siguientes niveles:

* **Azure Active Directory Tenant:** El Tenant es la identidad que facilita la autenticación y autorización para todos los usuarios en una suscripción de Azure. Es una instancia única que se crea cuando una organización se registra, cuenta con un dominio único que se usa para identificarlo y permite que los usuarios puedan iniciar sesión y acceder a los recursos y aplicaciones.
* **Root Management Group:** El Grupo de Administración Raíz es el nivel mas alto en la jerarquía si es que se tiene habilitado (por default no esta habilitado este grupo), lo que se recomienda por si es que se tiene una organización de un tamaño medio o grande. Se utiliza para aplicar políticas y directivas de gobernanza de alto nivel a nivel de la organización o empresa, lo que permite tener una administración centralizada y consistente de recursos en Azure. Se puede tener múltiples suscripciones de Azure agrupadas dentro de un solo grupo de administración Root. &#x20;
* **Child Management Group:** El Grupo de Administración Hijo se puede crear si es que se tiene habilitado el Grupo de Administración Raíz, este grupo permite a las organizaciones agrupar suscripciones en una estructura flexible, con el objetivo de poder gestionar los accesos y la gobernanza de los recursos agrupados.&#x20;
* **Subscription:** Para proveer recursos en Azure se necesita una suscripción. Cuando un cliente crea una cuenta en Azure, puede crear una o varias suscripciones que actúan como contenedores lógicos para organizar y administrar los recursos de Azure. Cada suscripción de Azure tiene un conjunto de recursos y límites asociados, y se factura por separado según el consumo de los servicios y recursos utilizados dentro de ella.
* **Resource Group:** Dentro de las suscripciones pueden haber grupos de recursos, los cuales son contenedores lógicos que pueden ser usados para agrupar y gestionar los recursos en Azure. Su mejor uso es el de colectar y juntar los recursos que necesiten ser gestionados de manera conjunta o que compartan un mismo ciclo de vida. Dependiendo de la arquitectura de la suscripción, esto puede resultar en un largo número de grupos de recursos para suscripciones individuales. (Se pueden ver como carpetas para organizar los recursos)
* **Individual Resources:**&#x20;

<figure><img src="../.gitbook/assets/image (24) (1) (1).png" alt=""><figcaption></figcaption></figure>



## Servicios de Azure

<figure><img src="../.gitbook/assets/image (9) (2) (4).png" alt=""><figcaption></figcaption></figure>

## Pentesting / Red Team

### Modelo de responsabilidad compartida

<figure><img src="../.gitbook/assets/image (6) (6).png" alt=""><figcaption></figcaption></figure>

### Restricciones de Cloud Penetration Testing

#### <mark style="color:green;">Lo que sí</mark>

A continuación se listan los productos que está dentro del alcance de una prueba de penetración:

* Azure Active Directory
* Microsoft Intune
* Microsoft Azure
* Microsoft Dynamics 365
* Microsoft Power Platform
* Microsoft Account
* Office 365
* Azure DevOps

En especial se promueve hacer pruebas sobre:

* Máquinas virtuales.
* Serverless functions, excluyendo el escape de una función.
* Pruebas de carga y estrés.
* Pruebas de políticas sobre MDM y MAM.
* Pruebas de monitoreo.

#### <mark style="color:green;">Lo que No se puede</mark>

* Denegación de servicio (Tráfico excesivo).
* Rever Shell sobre servicios PaaS y SaaS.

#### Fuentes

{% embed url="https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement" %}

{% embed url="https://learn.microsoft.com/en-us/azure/security/fundamentals/pen-testing" %}

## Amazon AWS to Microsoft Azure

| Amazon AWS                                     | Microsoft Azure                         |
| ---------------------------------------------- | --------------------------------------- |
| Elastic Compute Services - EC2                 | Azure Virtual Machines                  |
| Virtual Private Cloud - VPC                    | Virtual Network                         |
| Relational Database Services - RDS             | SQl Database, AZure Database            |
| Simple Storage Service                         | Azure Blob Storage                      |
| Lambda Serverless functions                    | Azure Functions                         |
| Identity and Access Management - iam           | Azure Active Directory                  |
| Identity and Access Management RBAC Components | Azure Role Base Access Control          |
| AWS Directory Services                         | Azures Active Directory Domain Services |
| Key Management Services                        | Key Vault                               |



## Referencias

{% embed url="https://learn.microsoft.com/en-us/azure/security/fundamentals/shared-responsibility" %}

